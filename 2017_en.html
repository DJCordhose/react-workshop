<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>React Workshop Part I</title>

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="reveal.js/css/reveal.css">
    <!--<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">-->
    <!--<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">-->
    <!--<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">-->
    <link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">


    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
    <style>
        /*pre code {*/
            /*display: block;*/
            /*padding: 0.5em;*/
            /*background: #FFFFFF !important;*/
            /*color: #000000 !important;*/
        /*}*/

        .right-img {
            margin-left: 10px !important;
            float: right;
            height: 500px;
        }
        .todo:before {
            content: 'TODO: ';
        }
        .todo {
            color: red !important;
        }
        code span.line-number {
            color: lightcoral;
        }
        .reveal pre code {
            max-height: 1000px !important;
        }

    </style>

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">
    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <h3>React Workshop - Vorbereitung</h3>
            <p>Falls noch nicht gemacht:</p>
            <ol>
                <li><code>git clone -b gh-pages https://github.com/DJCordhose/react-workshop.git</code></li>
                <li>Im geklonten Verzeichnis: <code>npm install</code></li>
                <li>Im geklonten Verzeichnis: <code>npm run setup</code></li>
                <li>In <code>code/workspace</code> wechseln</li>
                <li>Ausführen: <code>npm start</code></li>
                <li>Browser öffnen: http://localhost:8080</li>
            </ol>
            <p>Folien: Im geklonten Verzeichnis <code>2017_mobx_router.html</code>
            </p>
        </section>
        <section>
            <h1>React Workshop</h1>
            <p>
                <small><a href="http://nilshartmann.net">Nils Hartmann</a> / <a href="http://twitter.com/nilshartmann">@nilshartmann</a>
                </small>
            </p>
            <p>
                <small><a href="http://zeigermann.eu">Oliver Zeigermann</a> / <a href="http://twitter.com/djcordhose">@DJCordhose</a>
                </small>
            </p>
            <p><small><a href="http://djcordhose.github.io/react-workshop/2017_en.html">
                http://djcordhose.github.io/react-workshop/2017_en.html</a></small></p>
        </section>

<!--Title: Introduction into React-->

<!--Content:-->

	<!--* ES6 and React Basics-->
	<!--* Server calls using fetch-->
	<!--* Redux Basics-->
	<!--* Getting started with hops and malt-->


<!--Target Audience: Frontend and Fullstack Developers interested in React, no prior knowledge of React required-->


        <section>
            <h2>Day I</h2>
            <ul>
                <li><a href="#/t0">Part 0: Setup and Introduction into React (shorten and translate)</a>
                <li><a href="#/t1">Part I: React and ES6 Basics (shorten and translate)</a>
                <li><a href="#/t2">Part II: Composing Components (shorten and translate)</a>
                <li><a href="#/t3">Part III: Remote-Calls and Promises (shorten and translate)</a>
                <li><a href="#/t4">Part IV: Introduction to Redux (write)</a>
                <li>Part V: Bridging to Hops and Malt (no slides)
            </ul>
        </section>

        <section id="t0">
            <h1>Teil 0</h1>
            <h2>React-Einführung und Build-Prozess</h2>
        </section>

        <section id="react">
            <h2>React</h2>
            <ul>
                <li class="fragment">Framework für Facebook und viele andere
                <li class="fragment">Komponenten kapseln Template und Logik
                  <li class="fragment">Deklarativ
                <li class="fragment">Abstraktion vom DOM: <em>f(model) -> UI</em>
                <li class="fragment">Minimales API
                <li class="fragment">Ein-Weg-Data-Binding: Zustandsänderungen stellen Komponente <b>komplett</b> neu dar
                <li class="fragment">Kann im Browser und auf dem Server rendern
                <!--<li class="fragment">wird für komplette Anwendung typischerweise mit React Router und einem Flux-Framework gekoppelt-->
                <!--<li class="fragment">viel Inspiration aus der funktionalen Ecke (Immutable, pure functions, stateless)-->
            </ul>
        </section>

        <section>
            <h3>React Komponenten</h3>
            <ul>
                <li class="fragment">Werden als ES6 Klasse oder Funktion implementiert
                <li class="fragment">Keine Templatesprache (stattdessen JavaScript)
                <li class="fragment">Templates können HTML-artige Syntax enthalten (JSX)
            </ul>
            <pre class="fragment"><code data-trim contenteditable>class HelloMessage extends React.Component {
  render() {
    return &lt;h1 className='title'>Hello, World!&lt;/h1>
  }
}
</code></pre>
        </section>

        <section>
            <h3>Hello World React</h3>
                <a target="_blank" href="code/hello_world/public/index.html">Demo</a>
        </section>

        <section>
                <section>
                    <h3>Hello World React</h3>
<pre><code data-trim contenteditable>class HelloMessage extends React.Component {
  render() {
    return (&lt;div>
            &lt;input ref={input => this.input = input}
                   onChange={event => this.updateModel(event)}
                   value={this.state.greeting} />
            &lt;p>{this.state.greeting}, World&lt;/p>
            &lt;button
                onClick={() => this.reset()}>
                Clear
            &lt;/button>
        &lt;/div>);
  }</code></pre>
<pre class="fragment"><code contenteditable class="javascript">  constructor(props) {
    super(props);
    this.state = {greeting: this.props.greeting};
  }
  updateModel(event) {
    this.setState({greeting: event.target.value});
  }
  reset() {
    this.setState({greeting: ""});
    this.input.focus();
  }
}</code></pre>
                </section>

            <section>
                <h3>ES6: Klassen</h3>
                <pre class="fragment"><code class="javascript" contenteditable>class Person {
    constructor(name) {
        this._name = name;
    }
    get name() {
        return this._name;
    }
}
class Programmer extends Person {
    constructor(name, language) {
        super(name);
        this.language = language;
    }
    code() {
        return this.name + " codes in " + this.language;
    }
}</code></pre>
                <pre><code class="javascript" contenteditable>const programmer = new Programmer('Erna', 'JavaScript');
console.log(programmer.code());
console.log(programmer instanceof Programmer); // true
console.log(programmer instanceof Person); // true</code></pre>
            </section>



            <section>
            <h3>ES6: Arrow Functions</h3>
            <pre><code class="javascript" contenteditable>const displayInPage = (text) => {
   return document.body.innerHTML +=
       `${text}<br>`;
};</code></pre>
            <pre class="fragment"><code class="javascript" contenteditable>const displayInPage = text => document.body.innerHTML += `${text}<br>`;
</code></pre>
        </section>

                <!--<section>-->
                    <!--<h3>ES6: Lexcial Binding an this bei Arrow-Functions</h3>-->
<!--<pre><code class="javascript" contenteditable data-trim="">-->
<!--const obj = {-->
    <!--methodOfObj: function () {-->
      <!--console.log(`In Method: ${obj === this}`); // true-->
        <!--['1', '2', '3'].forEach( e => {-->
           <!--console.log(`In Loop: ${obj === this}`); // true-->
        <!--});-->
    <!--}-->
<!--};-->

<!--obj.methodOfObj();-->
<!--</code></pre>-->
            <!--</section>-->


        </section>

        <section>
                    <h3>Aufruf</h3>
<pre><code data-trim contenteditable>
// index.html
&lt;html>
  &lt;body>
    <div id="mount"></div>
  &lt;/body>
  &lt;script src="dist/main.js">&lt;/script>
&lt;/html>
</code></pre>
<pre class="fragment"><code data-trim contenteditable class="javascript">
// main.js
import HelloMessage from './HelloMessage';

const mountNode = document.getElementById('mount');
ReactDOM.render(&lt;HelloMessage greeting="Hello"/>, mountNode);
</code></pre>
                    <a target="_blank" href="code/hello_world/public/index.html">Run</a>
                </section>


    <section>
        <h2>Buildprozess</h2>
        <ul>
            <li>ES6- und JSX-Code muss nach ECMAScript 5 übersetzt werden
            <li>Typische Werkzeuge
                <ul><li>Babel (Compiler)
                    <li>Webpack (Bundler)
                    <li>Webpack Dev Sever (HTTP Server mit Hot Reload)
                    </ul>
        </ul>
    </section>
     <section>
        <h2>Webpack und Babel</h2>
        <img src="webpack-und-babel.png" style="border:0;box-shadow:0 0 0 0"/>
    </section>

    </section>
    <section>
      <section>
          <h2>Übung: React Hello-World</h2>
          <h3>Mach dich mit den Werkzeugen vertraut und schreib deine erste React-Komponente</h3>
      </section>
      <section>
          <h3>Schritt #1: Tool-Chain starten</h3>
          <p>Nutze das <code>workspace</code>-Verzeichnis in diesem Repository</p>
          <p>Hier ist eine Tool-Chain mit Webpack und Babel vorbereitet</p>
          <ul>
              <li>Evtl. dafür einen Proxy konfigurieren <a target="_blank" href="http://wil.boayue.com/blog/2013/06/14/using-npm-behind-a-proxy/">http://wil.boayue.com/blog/2013/06/14/using-npm-behind-a-proxy/</a></li>
              <li><code>npm install</code> (auf oberster Ebene)
              <li><code>npm run setup</code> (auf oberster Ebene)
              <li><code>cd code/workspace</code>
              <li><code>npm run devserver</code>
              <li>Öffne <a href="http://localhost:8080" target="_blank">http://localhost:8080</a> im Browser
              <li>Wenn auf der Seite 'Hello, World' steht, ist alles gut
          </ul>
      </section>
      <section>
          <h3>Schritt #2: Deine erste React-Komponente</h3>
          <ul>
              <li>Ersetze die "statische" Komponente (HelloMessage) mit der React-Komponente aus dem vorherigen Beispiel aus den Folien
              <li>Experimentiere mit der Anwendung, mache einige Änderungen, wie z.B.
                  <ul>
                      <li>Alle Eingaben sollen in Großbuchstaben auftauchen
                      <li>Gib irgendeine Rückmeldung wenn die Eingabe erfolgreich gelöscht wurde
                  </ul>
          </li>
          </ul>
      </section>
    </section>

        <section id="t1">
            <h1>Teil I</h1>
            <h2>React-Komponenten und ES6 Grundlagen</h2>
            <a href="code/schritte/1-detail/public/index.html" target="_blank">Ziel-Anwendung</a>
        </section>

        <section>
            <h3>Themen</h3>
            <ul>
                <li>Rendering
                <li>Properties und Zustand
                <li>Refs
            </ul>
        </section>

        <section>
            <h2>ES6-Referenz</h2>
            <p><a href="http://exploringjs.com/es6/" target="_blank">
                http://exploringjs.com/es6/
            </a>
        </section>

            <section>
                <h3>React: Rendering</h3>
                <ul class="fragment">
                    <li>Jede React-Komponente braucht eine <code>render</code>-Methode:</li>
                    <li>wird aufgerufen beim ersten Rendering und wenn sich der Zustand ändert</li>
                    <li>kann HTML-artige JSX-Syntax nutzen</li>
                    <li>JSX kann pures JavaScript in geschweiften Klammern enthalten (<code>{}</code>)
                </ul>
<pre class="fragment"><code class="xml" contenteditable data-trim>
class GreetingDetail extends React.Component {
  render() {
    return (
      <div>
        &lt;input ref={input => this.input = input}
           onChange={event => this.updateModel(event.target.value)}
           value={this.state.greeting} />
        <p>{this.state.greeting}, World</p>
      </div>
    );
  }
  // ...
}
</code></pre>
        </section>
           <section>
                <h3>React: Rendering #2</h3>
                <ul class="fragment">
                    <li>DOM-Events werden in React-Events verpackt
                    <li>React-Events haben weitgehend selbe API wie DOM-Events
                    <li>Es gibt keine automatische Bindung an Modelle
                </ul>
<pre class="fragment"><code class="xml" contenteditable data-trim>
class GreetingDetail extends React.Component {
  render() {
    return (
      <div>
        &lt;input ref={input => this.input = input}
               onChange={event => this.updateModel(event.target.value)}
               value={this.state.greeting} />
        <p>{this.state.greeting}, World</p>
      </div>
    );
  }
  updateModel(greeting) {
    this.setState({greeting});
  }
  // ...
}
</code></pre>
        </section>
        <section>
            <h3>ES6: Erweiterte Objekt-Literale</h3>
   <pre><code class="javascript" contenteditable>const name = 'Oma';
const person = {
    // ES5: name: name
    name
};
console.log(person.name); // Oma
   </code></pre>
        </section>


                    <section>
                        <h2>ES6: Module, Importe und Exporte</h2>
                    </section>
                    <section>
                        <h3>ES6: Export einer einzigen Klasse</h3>
   <pre><code class="javascript" contenteditable>// Person.js
class Person {
  // ...
}
export default Person;
   </code></pre>
                    </section>
                    <section>
                        <h3>ES6: Import</h3>
   <pre><code class="javascript" contenteditable>// Programmer.js
import Person from './Person';

export default class Programmer extends Person {
  // ...
}
   </code></pre>
                    </section>
                    <section>
                        <h3>ES6: Benannte Exporte</h3>
   <pre><code class="javascript" contenteditable data-trim>// util.js
export function displayInPage(text) {
    document.body.innerHTML +=
        `${text}<br>` ;
}
// or
export { displayInPage };
   </code></pre>
   <pre class="fragment"><code class="javascript" contenteditable data-trim>import {displayInPage} from "./util";
displayInPage('Hello, World');
   </code></pre>
   <!--<pre class="fragment"><code class="javascript" contenteditable data-trim>import {displayInPage as display} from "./util";-->
<!--display('Hello, World');-->
   <!--</code></pre>-->
   <!--<pre class="fragment"><code class="javascript" contenteditable data-trim>import * as util from "./util";-->
<!--util.displayInPage('Hello, World');-->
   <!--</code></pre>-->
                    </section>
        <!--<section>-->
                        <!--<h2>Neuerungen und Verbesserungen in ES6</h2>-->
                    <!--</section>-->

                    <!--<section>-->
                      <!--<h3>Tagged Template Literals</h3>-->
          <!--<p><a target="_blank" href="http://exploringjs.com/es6/ch_template-literals.html#_tagged-templates">-->
         <!--Mini-DSLs: Template-Literals mit tag-->
    <!--</a>-->
    <!--</p>-->

   <!--<pre class="fragment"><code class="javascript" contenteditable>function tag(strings, ...values) {-->
  <!--console.log(strings);-->
  <!--//[ '', ' codes in ', '.' ]-->
  <!--console.log(values);-->
  <!--//[ 'Oma', 'Haskell' ]-->
  <!--return 'whatever you want';-->
<!--}-->
<!--</code></pre>-->

   <!--<pre><code class="javascript" contenteditable>const expanded = tag`${person} codes in ${language}.`;-->
<!--console.log(expanded);-->
<!--//whatever you want-->
<!--</code></pre>-->

                    <!--</section>-->

                    <section>
                        <h3>ES6: Destructuring von Objekten</h3>
   <pre><code class="javascript" contenteditable>const person = {
  name: 'Olli',
  email: 'oliver.zeigermann@gmail.com'
};</code></pre>
   <pre class="fragment"><code class="javascript" contenteditable>const {name, notThere} = person;
console.log(`name=${name}`);
// name=Olli
console.log(`notThere=${notThere}`);
// notThere=undefined
</code></pre>
   <!--<pre class="fragment"><code class="javascript" contenteditable>const {address: {city}} = person;-->
<!--console.log(`city=${city}`);-->
<!--//city=Hamburg-->
<!--</code></pre>-->
                    </section>
                    <!--<section>-->
                        <!--<h3>Destructuring bei Parametern</h3>-->
   <!--<pre><code class="javascript" contenteditable>const person = {-->
  <!--name: 'Olli',-->
  <!--address: {-->
    <!--city: 'Hamburg'-->
  <!--},-->
  <!--email: 'oliver.zeigermann@gmail.com'-->
<!--};</code></pre>-->
   <!--<pre class="fragment"><code class="javascript" contenteditable data-trim>-->
<!--function print({email: contact}) {-->
    <!--console.log(`contact=${contact}`);-->
<!--}-->
<!--print(person);-->
<!--// contact=oliver.zeigermann@gmail.com-->
<!--</code></pre>-->
   <!--<pre class="fragment"><code class="javascript" contenteditable data-trim>-->
<!--function g({name: x, y, z=10}) {-->
  <!--console.log(`x=${x}`); // x=olli-->
  <!--console.log(`y=${y}`); // y=undefined-->
  <!--console.log(`z=${z}`); // z=10-->
<!--}-->
<!--g({ name: 'olli' });-->
<!--</code></pre>-->
                    <!--</section>-->
                    <!--<section>-->
                        <!--<h3>Destructuring bei Arrays</h3>-->
   <!--<pre><code class="javascript" contenteditable>const [a, b] = [1, 2];-->
<!--console.log(`a=${a}`);-->
<!--// a=1-->
<!--console.log(`b=${b}`);-->
<!--// b=2-->
<!--</code></pre>-->
   <!--<pre class="fragment"><code class="javascript" contenteditable data-trim>-->
<!--const [, b] = [1, 2];-->
<!--console.log(`b=${b}`);-->
<!--//b=2-->
<!--</code></pre>-->
                    <!--</section>-->
                    <!--<section>-->
                        <!--<h3>Erweiterte Objekt-Literale</h3>-->
   <!--<pre><code class="javascript" contenteditable>const name = 'Oma';-->
<!--const person = {-->
    <!--// ES5: name: name-->
    <!--name,-->
    <!--// ES5: toString: function()-->
    <!--toString() {-->
        <!--return this.name;-->
    <!--}-->
<!--};-->
<!--console.log(person.name); // Oma-->
<!--console.log(person.toString()); // Oma-->
   <!--</code></pre>-->
                    <!--</section>-->
                    <!--<section>-->
                        <!--<h3>for..of</h3>-->
          <!--<p><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of">-->
         <!--Iterieren über alles was 'iterable' ist-->
    <!--</a>-->
    <!--</p>-->

   <!--<pre><code class="javascript" contenteditable>for (const e of array2) {-->
    <!--console.log(e);-->
<!--}-->
<!--// Hi-->
<!--// Olli-->
<!--// how are you-->
<!--// ?-->
<!--</code></pre>-->
                    <!--</section>-->

    <!--<section>-->
                        <!--<h3>Spread-Operator</h3>-->
          <!--<p><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">-->
          <!--Alles was 'iterable' ist kann in einzelne Parameter transformiert werden-->
    <!--</a>-->
    <!--</p>-->
   <!--<pre><code class="javascript" contenteditable>const array1 = ['Olli', 'how are you'];-->
<!--const array2 = ['Hi', ...array1, '?'];-->
<!--console.log(array2);-->
<!--// => ["Hi", "Olli", "how are you", "?"]-->
<!--</code></pre>-->
   <!--<pre class="fragment"><code class="javascript" contenteditable>console.log(...array1);-->
<!--</code></pre>-->
                    <!--</section>-->

                <!--<section>-->
                    <!--<h2>Verbesserungen bei Funktionen in ES6</h2>-->
                <!--</section>-->


        <section>
            <h3>React: Properties und Zustand</h3>
            <ul class="fragment">
                <li><b>Properties</b> werden der Komponente von <b>außen</b> übergeben (und nicht verändert)</li>
                <li><b>Zustand (State)</b> ist eine <b>innere</b> Eigenschaft der Komponente (die verändert werden kann)</li>
                <li>Beides sind Objekte mit Key-Value-Paaren</li>
                <li>Beide können an Unterkomponenten übergeben werden</li>
            </ul>
        </section>

        <section>
            <h3>Properties einer Komponente</h3>
            <ul class="fragment">
                <li>Properties werden von außen über den Konstruktor übergeben</li>
                <li>Properties dürfen nicht verändert werden</li>
                <li>Zugriff über <code>this.props</code></li>
            </ul>
            <pre class="fragment"><code class="javascript" contenteditable data-trim>
class TitleComponent extends React.Component {
    constructor(props) {
        super(props);
    }
    render() {
      return &lt;h1>{this.props.title}&lt;/h1>
    }
   // ...
}
</code></pre>
<pre class="fragment"><code class="javascript" contenteditable data-trim>
  &lt;TitleComponent title='Hello World' />
</code></pre>

        </section>

        <section>
            <h3>Zustand einer Komponente</h3>
            <ul class="fragment">
                <li>Beispiel: Inhalt eines Eingabefelds, Daten vom Server</li>
                <li>Werte üblicherweise immutable</li>
                <li>Initialisieren im Konstruktor mit <code>this.state={}</code>
                <li>Zustand <b>lesen</b> über <code>this.state</code>
                <li>Zustand <b>setzen</b> über <code>this.setState()</code>
                <ul><li>kein "reiner" Setter</li>
                    <li>Führt alten und neuen Zustand zusammen</li>
                    <li><b>Löst erneutes rendern der <i>gesamten</i> Komponente aus</b></li>
                </ul>
            </ul>
            </section>

            <section>
                <h3>Beispiel: Zustand einer Komponente</h3>
<pre><code class="javascript" contenteditable data-trim>
class GreetingDetail extends React.Component {
    constructor(props) {
        super(props);
        this.state = { name: 'Klaus' };
    }

    updateModel(event) {
        // Zustand ändern: Komponente wird neu gerendert
        this.setState({name: event.target.value});
    }

    render() {
        return &lt;input value={this.state.name}
            onChange={e => this.updateModel(e)} />
    }
   // ...
}
</code></pre>
        </section>
        <section>
            <h3>Render Zyklus</h3>
            <img src="event-zustand-render.png" height="550" style="border:0;box-shadow:0 0 0 0">
        </section>

        <section>
            <h3>Virtual DOM</h3>
            <img src="virtual-dom.png" style="border:0;box-shadow:0 0 0 0">
        </section>

        <section>
            <h3>React: Refs</h3>
            <ul class="fragment">
                <li>Beim rendern kann man an eine Referenz des unterliegenden DOMs kommen
                <li>die DOM-Referenz kann einer Funktion übergeben werden
                <li>Diese Referenz kann man z.B. als Member-Variable speichern
            </ul>
<pre class="fragment"><code class="javascript" contenteditable data-trim>
class HelloMessage extends React.Component {
    render() {
        return (
            <div>
                &lt;input ref={input => this.input = input} />
                &lt;button
                    onClick={() => this.input.focus()}>
                    Focus
                &lt;/button>
            </div>);
    }
}
</code></pre>
        </section>

        <section>
      <section>
          <h2>Übung: Detail-Ansicht für unsere Gruß-Anwendung</h2>
          <h3>Erzeuge eine Komponenten mit der man einen Namen und eine Grußformel eingeben kann</h3>
      </section>
      <section>
          <h3>Schritte</h3>
          <h4>Erweitere deine erste React-Komponente im workspace-Ordner</h4>
          <ul>
              <li>benenne deine Komponente in <code>GreetingDetail</code> um
              <li>du brauchst zwei Eingabefelder, die <code>name</code> und <code>greeting</code> im Zustand der Komponente setzen
              <li>für etwas Styling kopiere das Material in <code>code/material/1-detail</code> in deinen <code>public</code>-Ordner
              <li><em>Zusatzaufgabe: Erweitere deine Komponente so, dass man von außen Properties übergeben kann, die den Zustand initialisieren</em>
          </ul>
      </section>
    </section>


        <section id="t2">
            <h1>Teil II</h1>
            <h2>Komponentenhierarchien</h2>
            <h3>Komplette Anwendung aus Komponenten bauen</h3>
            <a href="code/schritte/2-hierarchy/public/index.html" target="_blank">Ziel-Anwendung</a>
        </section>

        <section>
            <h2>Referenz</h2>
            <p><a href="https://facebook.github.io/react/docs" target="_blank">
                https://facebook.github.io/react/docs
            </a>
            </p>
        </section>

        <section>
            <h3>Themen</h3>
            <ul>
                <li>Komponenten als Funktion
                <li>Darstellung von Listen und Keys
                <li>Architektur-Idee: Controller-Komponente und View-Komponente
                <li>Durchreichen von Zustand und Callbacks
                <li>PropTypes
            </ul>
        </section>

            <section>
                <h3>Komponenten als Funktion</h3>
                <ul class="fragment">
                    <li>Komponente ist eine einfache Funktion</li>
                    <li>entspricht der <code>render</code>-Methode</li>
                    <li>Properties werden als Parameter übergeben</li>
                    <li>Zurzeit nur ohne Zustand und ohne Lifecycle-Methoden</li>
                </ul>
<pre class="fragment"><code class="xml" contenteditable data-trim>
function Layout(props) {
  return (
      <div className="Main">
        <div className="Container">
          {props.children}
        </div>
      </div>
  );
}
</code></pre>
        </section>

            <section>
                <h3>Listen und Keys</h3>
                <ul class="fragment">
                    <li>JSX bietet nichts für Listen
                    <li>Ausgabe typischerweise über <code>Array.map</code>
                    <li>Elemente einer Liste brauchen einen eindeutigen key
                </ul>
<pre class="fragment"><code class="javascript" contenteditable data-trim>
const greetings = [{
    id: 0,
    name: 'Olli',
    greeting: 'Huhu'
},
{
    id: 1,
    name: 'Oma',
    greeting: 'Hallo'
}
];
const body = greetings.map(greeting =>
    &lt;tr key={greeting.id}>
        &lt;td>{greeting.name}</td>
        &lt;td>{greeting.greeting}</td>
    &lt;/tr>);
</code></pre>
        </section>

        <section>
            <h3>Controller und Child-Views</h3>
            <img src="controller.png" height="600" style="border:0;box-shadow:0 0 0 0">
        </section>

        <section>
            <h3>Durchreichen vom Zustand und Callbacks</h3>
            <ul class="fragment">
                <li>Funktioniert beides über Properties
            </ul>
<pre class="fragment"><code class="javascript" contenteditable data-trim>
class GreetingController extends React.Component {
    render() {
        const {greetings} = this.state;
        return (
            <div>
                &lt;GreetingMaster greetings={greetings}
                    onAdd={() => this.setState({mode: MODE_DETAIL})}
            </div>);
    }
    // ...
}
    </code></pre>
    </section>
    <section>
        <h3>Properties übergeben mit Object-Spread</h3>
        <ul class="fragment">
                <li>Übergibt <b>alle</b> Eigenschaften eines Objektes als individuelle Properties</li>
        </ul>
        <pre class="fragment"><code class="javascript" contenteditable data-trim>
class GreetingController extends React.Component {

    const greeting = { name: 'Klaus', greeting: 'Hello' };

    render() {
        return &lt;GreetingDetail {...greeting} />

        // entspricht:
        // &lt;GreetingDetail name='Klaus' greeting='Hello' />
    }
}
        </code></pre>
    </section>

        <section>
            <h3>PropTypes</h3>
                <ul class="fragment">
                    <li>Eine Komponente kann deklarieren, welche Properties sie erwartet
                    <li>Auch der Typ kann angegeben werden
                    <li>Fehlende / falsche Properties führen zu Laufzeitfehlern
                    <li><a href="https://facebook.github.io/react/docs/reusable-components.html#prop-validation " target="_blank">Mögliche Typen</a>
                </ul>
<pre class="fragment"><code class="javascript" contenteditable data-trim>
GreetingDetail.propTypes = {
    greeting: PropTypes.shape({
      name: React.PropTypes.string.isRequired,
      greeting: React.PropTypes.string.isRequired
    }),
    onAdd: PropTypes.func.isRequired
};
</code></pre>
        </section>

        <section>
            <section>
                <h2>Übung: Eine komplette Anwendung zusammen setzen</h2>
                <h3>Füge deinen Detail-View und einen Master-View über eine Controller-Komponente zusammen</h3>
            </section>
            <section>
                <h3>Schritte</h3>
                <ul>
                    <li>kopiere das Material aus <code>code/material/2-hierarchy</code> in deinen src-Ordner
                    <li>erweitere im <code>GreetingController</code> die render-Methode, so dass dein Detail-View ebenfalls angezeigt wird, wenn der Benutzer den Add-Button klickt
                    <li>dort gibt es bereits einen Kommentar, der dir die richtige Stelle anzeigt und weitere Details enthält
                    <li>übergib einen Callback der <code>addGreeting</code> nutzt
                    <li>im deinem <code>GreetingDetail</code> brauchst du einen neuen Knopf, der mit dem neuen Gruß den Callback aufruft
                </ul>
            </section>
            <section>
                <h3>Architektur Beispiel-Anwendung</h3>
                <img src="greeting-hierarchy.png" style="border:0;box-shadow:0 0 0 0"/>
            </section>
            <section>
                <h3>GreetingMaster</h3>
                <img src="greeting-master.png" style="border:0;box-shadow:0 0 0 0"/>
            </section>
            <section>
                <h3>GreetingDetail</h3>
                <img src="greeting-detail.png" style="border:0;box-shadow:0 0 0 0"/>
            </section>
        </section>

        <section id="t3">
            <h1>Teil III</h1>
            <h2>Remote-Calls gegen Server</h2>
            <a href="code/schritte/3-remote/public/index.html" target="_blank">Ziel-Anwendung</a>
        </section>

        <section>
            <h3>Herausforderungen</h3>
            <ul>
                <li>Wo speichern wir?
                <li>Wie machen wir das Laden und Speichern technisch?
                <li>Wie funktioniert asynchrone Verarbeitung in React?
                <li>Wo steht der Code zum initialen Laden der Grüße?
            </ul>
        </section>

            <section>
                <h3>fetch</h3>
                <p>Browser-API zum Laden und Speichern von Daten</p>
<pre><code class="javascript" contenteditable data-trim>
fetch(url, {
    method: 'PUT',
    headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(payload)
})
.then(response => response.json())
.then(json => /* ... */)
.catch(ex => console.error('request failed', ex));
</code></pre>
            </section>


        <section>
            <h2>Promises</h2>
        </section>
                <section>
                        <h3>fetch</h3>
<pre><code class="javascript" contenteditable>const url = `${BACKEND_URL}${path}`;

return fetch(url)
    .then(response => response.json())
    .then(json => /* ... */)
    .catch(ex => console.error('request failed', ex));
</code></pre>
                </section>
                    <section>
                        <h3>Ein Promise ist ein Versprechen auf einen Wert</h3>
                        <h4 class="fragment">Wird evtl. erst in der Zukunft eingelöst</h4>
                    </section>

                <section>
                        <h3>Erzeugen und asynchron reagieren</h3>
   <pre class="fragment"><code class="javascript" contenteditable>const promise = new Promise(resolve =>
    setTimeout(
        () => resolve('Result from promise'),
        1000)
);
</code></pre>
    <pre><code class="javascript" contenteditable>promise.then(value => console.log(value));
// Output after 1 second: Result from promise
</code></pre>
                    </section>
                    <section>
                        <h3>Verkettete Ausführung</h3>
   <pre><code class="javascript" contenteditable>const promise = new Promise(resolve =>
    setTimeout(
        () => resolve('Result from promise'),
        1000)
);
</code></pre>
    <pre class="fragment"><code class="javascript" contenteditable>// then returns a new promise
const promise2 = promise.then(value => `${value} plus stuff`);</code></pre>
    <pre class="fragment"><code class="javascript" contenteditable>promise2.then(value => console.log(value));
// Output after 1 second: Result from promise plus stuff
</code></pre>
                    </section>
            <section>
                <h3>Fehler führen zum Abbruch der Chain</h3>
                <h4 class="fragment">Allerdings muss man etwas tun, um das mitzubekommen</h4>
            </section>

                    <section>
                        <h3>Catch-Klausel</h3>
   <pre><code class="javascript" contenteditable>Promise
    // creates and directly resolves promise
    .resolve('Result from promise')
    .then(x => {
        // this will be printed
        console.log(x);
    })
    .then(() => {
        console.log('This will be printed');
    })
    // this will NOT be printed as no error occured
    .catch(e => console.log('error: ', e))

// Output:
// Result from promise
// This will be printed</code></pre>
                    </section>
                    <section>
                        <h3>Catch-Klausel im Fehlerfall</h3>
   <pre><code class="javascript" contenteditable>Promise
    // creates and directly resolves promise
    .resolve('Result from promise')
    .then(x => {
        // this will be printed
        console.log(x);
        throw new Error('Something went wrong');
    })
    .then(() => {
        console.log('This will NOT be printed');
    })
    // this will be printed
    .catch(e => console.log('error: ', e))

// Output:
// Result from promise
// error:  [Error: Something went wrong]</code></pre>
                    </section>
                    <section>
                        <h3>Catch-Klausel bei Ablehnung</h3>
   <pre><code class="javascript" contenteditable>Promise
    // creates and directly rejects promise
    .reject('Promise rejected')
    .then(x => {
        // this will NOT be printed
        console.log(x);
    })
    .then(() => {
        console.log('This will NOT be printed');
    })
    // this will be printed
    .catch(e => console.log('error: ', e))

// Output:
// error:  Promise rejected</code></pre>
                </section>
        <section>
            <section>
                <h2>Übung: Laden und Speichern der Daten von/auf einem Server</h2>
                <p>Entwickle auf Basis von fetch eine Version, die die Daten auf dem Server laden und dort wieder speichern kann</p>
                <p>Der Server ist bereits vorgegeben und kann mit <code>npm start</code> im Root-Verzeichnis gestartet werden. Er ist dann unter Port 7000 erreichbar</p>
            </section>

        </section>
        <section id="t4">
            <h1>Part IV</h1>
            <h2>State Management using Redux</h2>
            <a href="code/schritte/5-redux/public/index.html" target="_blank">Application</a>
        </section>

        <section>
            <h2>Reference</h2>
            <p>Redux Core: <a href="http://redux.js.org/" target="_blank">
                http://redux.js.org/
            </a>
            </p>
            <p>Binding to React: <a href="https://github.com/reactjs/react-redux" target="_blank">
                https://github.com/reactjs/react-redux
            </a>
            </p>

        </section>

        <section>
            <h2>Motivation</h2>
            <p class="fragment">State distributed over many components can make applications hard to understand and debug</p>
            <p class="fragment">Often more than one component depends on a certain part of state -
                especially hard to do when components are not even in the same hierarchy </p>
            <p class="fragment"><strong>Redux extracts state management and handlers from React components</strong></p>
        </section>

        <section>
            <h2>Render Cycle in Pure React</h2>
            <img src="redux-01-react-cycle-no-redux.png" style="border:0;box-shadow:0 0 0 0"/>
        </section>

        <section>
            <h2>Redux Extracts Responsibilities</h2>
            <img src="redux-02-extracting-responsibility.png" style="border:0;box-shadow:0 0 0 0"/>
        </section>

        <section>
            <h2>Resulting Redux Architecture</h2>
            <img src="redux-03-resulting-redux-architecture.png" style="border:0;box-shadow:0 0 0 0"/>
        </section>

        <section>
            <h3>Event-Handlers become Action-Creators</h3>
           <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
export function setFilter(filter) {
    return {
        type: SET_FILTER,
        filter
    };
}
</code></pre>
            <ul>
                <li class="fragment">Action-Creators create Action-Objects</li>
                <li class="fragment">Actions are command like structures of things to do by application</li>
                <li class="fragment">They are passed to all reducers using dispatch method of store</li>
                <li class="fragment">Actions consist of type and random payload</li>
            </ul>
        </section>

        <section>
            <h3>Action-Creators making server calls</h3>
            <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
export const loadGreetings = dispatch => {
    return fetch(BACKEND_URL)
        .then(response => response.json())
        .then(greetings => dispatch({
            type: SET_GREETINGS,
            greetings
        });
    );
};
</code></pre>
            <ul>
                <li class="fragment">As call is async, we need to get the dispatch method passed in</li>
            </ul>
            <p  class="fragment"><strong>Action-Creators are the only part of the application allowed to perform async operations, like server calls</strong></p>
        </section>

        <section>
            <h3>A <em>single</em> Store holds <em>all</em> State</h3>
           <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
import { Provider } from 'react-redux';
import { createStore } from 'redux';
import { rootReducer } from './reducers';

// http://redux.js.org/docs/api/createStore.html
const store = createStore(
    rootReducer // reducer
);
ReactDOM.render(
    &lt;Provider store={store}>
        &lt;GreetingController />
    &lt;/Provider>,
    mountNode
);
        </code></pre>
            <ul>
                <li class="fragment">Central part of application</li>
                <li class="fragment">Provides the dispatch method used in action creators</li>
                <li class="fragment">Made available to all Components using Provider wrapper</li>
            </ul>
        </section>

        <section>
            <h3>Middleware sits between dispatch and store</h3>
            <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
import { applyMiddleware } from 'redux';
import thunk from 'redux-thunk';

const store = createStore(
    rootReducer, // reducer
    applyMiddleware(thunk) // middleware as enhancer
);
        </code></pre>
            <ul>
                <li class="fragment">Thunk middleware serves as a de-facto standard</li>
                <li class="fragment">Passes in the dispatch method into the async action creator</li>
                <li class="fragment"><a href="https://github.com/gaearon/redux-thunk#whats-a-thunk" target="_blank">
                    A thunk is a function that wraps an expression to delay its evaluation.
                </a></li>
                <li class="fragment">You don't have to worry about it for basic Redux usage</li>
            </ul>
        </section>

        <section>
            <h3>Reducers contain core (business) logic</h3>
            <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
import {combineReducers} from 'redux';

// http://redux.js.org/docs/api/combineReducers.html
export const rootReducer = combineReducers({
    greetings, // updates greeting partial state
    filter,
    mode
});
        </code></pre>
            <ul>
                <li class="fragment">A pure function that takes old state plus action and returns a new state</li>
                <li class="fragment">Often composed of reducers only updating partial state</li>
            </ul>
        </section>

        <section>
            <h3>Partial Reducers</h3>
            <pre class="fragment"><code class="typescript line-numbers" contenteditable data-trim>
const mode = (state = MODE_MASTER, action) => {
    switch (action.type) {
        case SET_MODE:
            return action.mode;
        default:
            return state;
    }
};
        </code></pre>
            <ul>
                <li class="fragment">Initialize part of the state (often using default parameters)</li>
                <li class="fragment">Never mutate state</li>
                <li class="fragment">Always return a (not necessarily complete) copy of state fragment</li>
                <li class="fragment">Depend on action and state structure</li>
            </ul>
        </section>

        <section class="todo">
<pre>
- Reducer
- connected component
- Excercise: make your application Redux, was vorgeben in Material?
</pre>
        </section>
        <section>
            <section>
                <h2>Excercise: Complete Redux Application</h2>
                <h3>The application is already working with Redux, but filtering from the Chart still needs to be done</h3>
            </section>
            <section>
                <h3>Steps</h3>
                <ul>
                    <li>Copy all material from <code>code/material/5-redux</code> to your source folder
                    <li>TODOs have been added to actions, reducers and GreetingController to guide you through the exercise
                    <li>Use the existing filter code from the previous step as a starting point
                    <li>Add an Action Type and an action creator for filtering
                    <li>Add a reducer to handle such an action and add it to <code>combineReducers</code>
                    <li>In <code>GreetingController</code> import the action creator and pass it down to the Chart to react to
                    filtering events
                </ul>
            </section>
        </section>

    </div>

</div>

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>
<script src="lib/jquery-2.2.4.js"></script>
<script>
    Reveal.addEventListener( 'ready', function( event ) {
        if (window.location.hostname.indexOf('localhost') !== -1) {
            // only applies to presentation version
            Reveal.configure({ controls: false });
        } else {
            // only applies to public version
            $('.fragment').removeClass('fragment');
        }
        // applies to all versions
        $('code').addClass('line-numbers');
    } );
</script>


<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'reveal.js/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'reveal.js/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'reveal.js/plugin/zoom-js/zoom.js', async: true},
            {src: 'reveal.js/plugin/notes/notes.js', async: true},
            {src: 'lib/js/line-numbers.js'}
        ]
    });

</script>

</body>
</html>
